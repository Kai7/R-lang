setwd("Program/R-lang/")
setwd("StatMethods/")
url <- "http://ghuang.stat.nctu.edu.tw/course/statmethods16/files/data/maleMiceWeights.csv"
filename <- basename(url)
download.file(url, destfile=filename)
x <- read.csv(filename)
x
x_norm <- x$Bodyweight[x$Diet == chow]
x_norm <- x$Bodyweight[x$Diet == "chow]
""
""
x_norm <- x$Bodyweight[x$Diet == "chow"]
x_norm
x
x_hf <- x$Bodyweight[x$Diet == "hf"]
ratio <- var(x_norm)/var(x_hf)
ratio
round(ratio, 4)
url <- "http://ghuang.stat.nctu.edu.tw/course/statmethods16/files/data/malemice_pheno.csv"
filename <- basename(url)
download.file(url, destfile=filename)
x_pop <- read.csv(filename)
x_pop
xpop_norm <- x_pop$Bodyweight[x_pop$Diet == "chow"]
xpop_hf <- x_pop$Bodyweight[x_pop$Diet == "hf"]
N <- 1000
n <- 12
samvar = vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samvar[i] <- var(sample(xpop_norm, n))
}
mypar(1,2)
hist(samvar)
qqnorm(samvar)
qqline(samvar,col=2)
library(rafalib)
mypar(1,2)
hist(samvar)
qqnorm(samvar)
qqline(samvar,col=2)
tt <- rep(0, 10)
tt
xpop_var <- var(x_pop)
qchi2.0025 <- qchisq(0.025, df = 11)
qchi2.0975 <- qchisq(0.975, df = 11)
conf = rep(0, N)
for(i in c(1:N)){
if(xpop_var >= (n-1)*samvar[i]/qchi2.0025 & xpop_var <= (n-1)*samvar[i]/qchi2.0975)
conf[i] <- 1
}
mean(conf)
xpop_var <- var(x_pop)
qchi2.0025 <- qchisq(0.025, df = 11)
qchi2.0975 <- qchisq(0.975, df = 11)
conf = rep(0, N)
for(i in c(1:N)){
if(xpop_var >= (n-1)*samvar[i]/qchi2.0025 && xpop_var <= (n-1)*samvar[i]/qchi2.0975)
conf[i] <- 1
}
mean(conf)
xpop_var <- var(x_pop)
qchi2.0025 <- qchisq(0.025, df = 11)
qchi2.0975 <- qchisq(0.975, df = 11)
conf = rep(0, N)
for(i in c(1:N)){
if((xpop_var >= (n-1)*samvar[i]/qchi2.0025) && (xpop_var <= (n-1)*samvar[i]/qchi2.0975))
conf[i] <- 1
}
mean(conf)
if((xpop_var >= (n-1)*samvar[i]/qchi2.0025))
xpop_var <- var(x_pop)
qchi2.0025 <- qchisq(0.025, df = 11)
qchi2.0975 <- qchisq(0.975, df = 11)
conf = rep(0, N)
for(i in c(1:N)){
if((xpop_var >= (n-1)*samvar[i]/qchi2.0025) && (xpop_var <= (n-1)*samvar[i]/qchi2.0975)){
conf[i] <- 1
}
}
mean(conf)
xpop_var
xpop_var <- var(x_pop$Bodyweight)
qchi2.0025 <- qchisq(0.025, df = 11)
qchi2.0975 <- qchisq(0.975, df = 11)
conf = rep(0, N)
for(i in c(1:N)){
if((xpop_var >= (n-1)*samvar[i]/qchi2.0025) && (xpop_var <= (n-1)*samvar[i]/qchi2.0975)){
conf[i] <- 1
}
}
mean(conf)
xpop_var
samvar
mean((n-1)*samvar/qchi2.0025 <= xpop_var & (n-1)*samvar/qchi2.0975 >= xpop_var)
mean((n-1)*samvar/qchi2.0025 <= xpop_var && (n-1)*samvar/qchi2.0975 >= xpop_var)
(n-1)*samvar/qchi2.0025
mean((n-1)*samvar/qchi2.0025 <= xpop_var)
mean((n-1)*samvar/qchi2.0025 >= xpop_var & (n-1)*samvar/qchi2.0975 <= xpop_var)
qchi2.0025
qchi2.0975
samvar
myF <- var(x_norm)/var(x_hf)
sam <- vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samF[i] <- var(sample(xpop_norm, n))/var(samele(xpop_hf, n))
}
mean(samF > myF)
myF <- var(x_norm)/var(x_hf)
samF <- vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samF[i] <- var(sample(xpop_norm, n))/var(samele(xpop_hf, n))
}
mean(samF > myF)
samF
myF <- var(x_norm)/var(x_hf)
samF <- vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samF[i] <- var(sample(xpop_norm, n))/var(samele(xpop_hf, n))
}
mean(samF > myF)
myF <- var(x_norm)/var(x_hf)
samF <- vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samF[i] <- var(sample(xpop_norm, n))/var(sample(xpop_hf, n))
}
mean(samF > myF)
samF
hist(samF)
hist(smaF)
abline(v=myF, col="red", lwd=2)
mean(samF > myF)
pf(myF, n-1, n-1)
1 - pf(myF, n-1, n-1)
round(1 - pf(myF, n-1, n-1))
round(1 - pf(myF, n-1, n-1), 4)
myF
fpermu <- replicate(1000, {
all <- sample(c(x_norm,x_hf))
new_x_norm <- all[1:n]
new_x_hf <- all[(n+1):(2*n)]
return(var(new_x_norm)/var(new_x_hf))
})
(sum(fpermu < myF) + 1) / (length(fpermu) + 1)
round((sum(fpermu < myF) + 1) / (length(fpermu) + 1))
round((sum(fpermu < myF) + 1) / (length(fpermu) + 1), 4)
var.test(x_norm~x_hf, na.action='na.omit')
var.test(x_norm, x_hf, na.action='na.omit')
myF
?var.test
var.test(x_norm, x_hf, alternative = "less", na.action='na.omit')
round(pf(myF, n-1, n-1), 4)
round((sum(fpermu < myF) + 1) / (length(fpermu) + 1), 4)
var.test(x_norm, x_hf, alternative = "less", na.action='na.omit')
myF <- var(x_norm)/var(x_hf)
samF <- vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samF[i] <- var(sample(xpop_norm, n))/var(sample(xpop_hf, n))
}
hist(smaF)
abline(v=myF, col="red", lwd=2)
mean(samF < myF)
hist(smaF)
abline(v=myF, col="red", lwd=2)
round(mean(samF < myF), 4)
N <- 1000
n <- 12
samvar = vector("numeric", N)
set.seed(1)
for(i in c(1:N)){
samvar[i] <- var(sample(xpop_norm, n))
}
mypar(1,2)
hist(samvar)
qqnorm(samvar)
qqline(samvar,col=2)
xpop_norm_var <- var(xpop_norm)
qchi2.0025 <- qchisq(0.025, df = 11)
qchi2.0975 <- qchisq(0.975, df = 11)
mean((n-1)*samvar/qchi2.0025 >= xpop_norm_var & (n-1)*samvar/qchi2.0975 <= xpop_norm_var)
hist(samF)
abline(v=myF, col="red", lwd=2)
round(mean(samF < myF), 4)
mypar(1,1)
hist(samF)
abline(v=myF, col="red", lwd=2)
round(mean(samF < myF), 4)
mypar(1,1)
hist(samF-1)
abline(v=myF-1, col="red", lwd=2)
round(mean(samF < myF), 4)
mypar(1,1)
hist(samF)
abline(v=myF, col="red", lwd=2)
round(mean(samF < myF), 4)
var(x_norm)
var(x_hf)
?var.test
var(xpop_norm)
var(xpop_hf)
xf = rf(1000, n-1, n-1)
hist(xf)
xf = rf(4096, n-1, n-1)
hist(xf)
xf = rf(4096, n-1, n-1)
hist(xf)
xf = rf(4096, n-1, n-1)
hist(xf)
xf = rf(4096, n-1, n-1)
hist(xf)
xf = rf(4096, n-1, n-1)
hist(xf)
xf = rf(4096, n-1, n-1)
hist(xf)
